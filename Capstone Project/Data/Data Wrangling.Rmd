---
title: "Data Wrangling"
author: "Aaron"
date: "4/18/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load Data and Libraries...
```{r message=FALSE}
library(dplyr)
library(tidyr)
library(reshape2)
jobs_by_sector <- read.csv("jobs_by_sector.csv")
jobs_by_sector <- tbl_df(jobs_by_sector)
home_prices <- read.csv("home_prices.csv")
home_prices <- tbl_df(home_prices)
total_jobs <- read.csv("total_jobs.csv")
total_jobs <- tbl_df(total_jobs)
unemployment <- read.csv("unemployment.csv")
unemployment <- tbl_df(unemployment)
apt_rents <- read.csv("apt_rents.csv")
apt_rents <- tbl_df(apt_rents)
```

## Data Wrangling
Clean up jobs_by_secotr df
```{r, message=FALSE}
jobs_by_sector <- melt(jobs_by_sector, variable.name = "Sector")
colnames(jobs_by_sector)[2] <- "Date"
jobs_by_sector <- spread(jobs_by_sector, Sector, value)
```
Clean up dates before joining all dfs
I started with home_prices. The second step worked perfectly except on "Sept" which returned NA. as.Date prefers the "Sep" abbreviation over "Sept" therefore I had to first substitute all "Sept" for "Sep" before converting all the string dates to date format.
```{r, message=FALSE}
# Step 1
home_prices$Date <- gsub("Sept", "Sep", home_prices$Date)
# Step 2
home_prices$Date <- home_prices$Date %>% 
    paste("01", sep = " ") %>% 
    as.Date(format = "%b %Y %d", "%b/%d/%Y")

# Same steps for total_jobs
total_jobs$Date <- gsub("Sept", "Sep", total_jobs$Date)
total_jobs$Date <- total_jobs$Date %>%
    paste("01", sep = " ") %>% 
    as.Date(format = "%b %Y %d", "%b/%d/%Y")

# Again for unemployment
unemployment$Date <- gsub("Sept", "Sep", unemployment$Date)
unemployment$Date <- unemployment$Date %>%
    paste("01", sep = " ") %>%
    as.Date(format = "%b %Y %d", "%b/%d/%Y")

# Slightly different strategy for apt_rents. Dates are integer format. First I added the day then converted to date format.
apt_rents$Date <- paste0("01/", apt_rents$Date)
apt_rents$Date <- apt_rents$Date %>% 
    as.Date(format = "%d/%m/%Y", "%b/%d/%Y")
```

